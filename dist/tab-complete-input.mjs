var t=function(t){for(var e in this.options={maxCache:10,enableCache:!0,insertOrder:!1,returnRoot:!1,insert:null,sort:null,clip:null,copy:null,merge:null},this.root={},this.index=0,t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);"function"!=typeof this.options.insert&&(this.options.insert=function(t,e){return this.options.insertOrder&&void 0===e.d&&void 0===e.o&&(e={d:e,o:this.index++}),t&&t.length?t.push(e):t=[e],t}),"function"!=typeof this.options.sort&&(this.options.insertOrder?this.options.insertOrder&&(this.options.sort=function(){this.sort(function(t,e){return t.o-e.o})}):this.options.sort=function(){this.sort()}),"function"!=typeof this.options.clip&&(this.options.clip=function(t){this.length>t&&this.splice(t,this.length-t)}),"function"!=typeof this.options.copy&&(this.options.copy=function(t){return t.slice(0)}),"function"!=typeof this.options.merge&&(this.options.merge=function(t,e,i){for(var o=0,s=e.length;o<s;o++)t=this.options.insert.call(this,t,e[o]),this.options.sort.call(t,i),this.options.clip.call(t,this.options.maxCache);return t})};t.prototype={_addCacheData:function(t,e){return!(this.root===t&&!this.options.returnRoot||!1===this.options.enableCache)&&(t.$d||(t.$d={}),t.$d=this.options.insert.call(this,t.$d,e),this.options.sort.call(t.$d),this.options.clip.call(t.$d,this.options.maxCache),!0)},_addSuffix:function(t,e,i){var o=t.charAt(0),s=t.substring(1)||null,n={$d:{}};s&&(n.$s=s),void 0===i[o]?i[o]=n:void 0===i[o].$d&&(i[o].$d={},s&&void 0===i[o].$s&&(i[o].$s=s)),i[o].$d=this.options.insert.call(this,i[o].$d,e),this.options.sort.call(i[o].$d)},_moveSuffix:function(t,e,i){var o=t.charAt(0),s=t.substring(1)||null,n={$d:{}};s&&(n.$s=s),void 0===i[o]&&(i[o]=n),i[o].$d=this.options.copy(e)},_getDataAtNode:function(t,e){var i;return this.options.enableCache?(this.options.sort.call(t.$d,e),i=t.$d):i=this._getSubtree(t,e),this.options.insertOrder&&(i=this._stripInsertOrder(i)),i?this.options.copy(i):void 0},_stripInsertOrder:function(t){if(void 0!==t){for(var e=[],i=0,o=t.length;i<o;i++)e.push(t[i].d);return e}},_getSubtree:function(t,e){for(var i,o,s=[t];o=s.pop();)for(var n in o)o.hasOwnProperty(n)&&("$d"==n?(void 0===i&&(i=[]),i=this.options.merge.call(this,i,o.$d,e)):"$s"!=n&&s.push(o[n]));return i},add:function(t,e){if("string"!=typeof t)return!1;1==arguments.length&&(e=t),t=t.toLowerCase();for(var i=this.root,o=0,s=t.length;o<s;o++){var n=t.charAt(o);if(i[n])o==s-1?(this._addCacheData(i,e),this._addCacheData(i[n],e)||this._addSuffix(n,e,i)):(this._addCacheData(i,e),i=i[n]);else{if(i.$s){if(i.$s==t.substring(o)){this._addCacheData(i,e)||(i.$d=this.options.insert.call(this,i.$d,e),this.options.sort.call(i.$d));break}this._moveSuffix(i.$s,i.$d,i),delete i.$s,!1===this.options.enableCache&&delete i.$d}if(!i[n]){this._addSuffix(t.substring(o),e,i),this._addCacheData(i,e);break}this._addCacheData(i,e),o==s-1&&(i[n].$s?(this._moveSuffix(i[n].$s,i[n].$d,i[n]),delete i[n].$s,!1===this.options.enableCache&&delete i[n].$d,this._addSuffix(n,e,i)):this._addCacheData(i[n],e)||this._addSuffix(n,e,i)),i=i[n]}}},remove:function(t){if("string"==typeof t&&""!==t&&!this.options.enableCache){t=t.toLowerCase();var e,i,o,s,n,r,a=this.root,d=0;for(i=0,o=t.length;i<o;i++){if(!a[e=t.charAt(i)]){if(a.$s&&a.$s===t.substring(i))break;return}s=a,n=e,a=a[e]}for(var l in r=this.options.copy(a.$d),this.options.insertOrder&&(r=this._stripInsertOrder(r)),delete a.$d,delete a.$s,a)a.hasOwnProperty(l)&&d++;return d||delete s[n],r}},contains:function(t){if("string"!=typeof t||""==t)return!1;t=t.toLowerCase();for(var e=this.root,i=0,o=t.length;i<o;i++){var s=t.charAt(i);if(!e[s])return!(!e.$s||e.$s!==t.substring(i));e=e[s]}return!(!e.$d||void 0!==e.$s)},find:function(t){if("string"==typeof t&&(""!=t||this.options.returnRoot)){t=t.toLowerCase();for(var e=this.root,i=0,o=t.length;i<o;i++){var s=t.charAt(i);if(!e[s])return e.$s&&0==e.$s.indexOf(t.substring(i))?this._getDataAtNode(e,t):void 0;e=e[s]}return this._getDataAtNode(e,t)}}};export default{name:"tab-complete-input",data:function(){return{trie:{},position:0,wordPos:0,index:0,words:[],word:"",dynamicData:!1,possible:!1,saved:!1,localValue:this.value}},render:function(t){var e=this;return t("input",{ref:"input",attrs:Object.assign({},e.$props),domProps:{value:e.value},directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"value"}],on:Object.assign({},e.$listeners,{keydown:e.$listeners.keydown?[e.tabComplete,e.$listeners.keydown]:e.tabComplete,input:function(t){e.localValue=t.target.value,e.$emit("input",t.target.value)}})})},created:function(){this.dynamicData=this.dataSource instanceof Function,this.dynamicData||this.setData(this.dataSource)},props:{dataSource:{default:[]},format:{default:function(t,e,i){return{word:t,prev:e}},type:Function},value:{default:"",type:String}},methods:{setData:function(e){var i=this;this.trie=new t,e.forEach(function(t){i.trie.add(t)})},tabComplete:function(t){try{var e=this;function i(){if(e.possible&&e.index>=e.possible.length&&(e.index=0),e.possible){t&&t.preventDefault();var i=e.words,o="";i.length>1&&(o=i[e.wordPos-1]);var s=e.format(e.possible[e.index],o,e.wordPos);i[e.wordPos]=s.word,s.prev&&(i[e.wordPos-1]=s.prev);var n=e.words.slice(0,e.wordPos+1).join(" ").length;e.localValue=i.join(" "),e.localValue=e.localValue.slice(0,n)+e.localValue.slice(n+1),e.updateValue(e.localValue),e.selectRange(n,n)}}if(t&&9!==t.keyCode)return e.saved=!1,e.index=0,Promise.resolve();var o=function(){if(!e.saved){function i(){e.saved=!0,e.possible=e.trie.find(e.word)}e.position=e.getCursorPos();var o=e.localValue.slice(0,e.position)+" "+e.localValue.slice(e.position);e.words=o.split(" ");for(var s=0,n=0;n<e.words.length;n++){if((s+=e.words[n].length+1)>=e.position){e.word=e.words[n],e.wordPos=n;break}}""!=e.word&&t&&t.preventDefault();var r=function(){if(e.dynamicData){var t=e.dataSource(e.word,e.wordPos);return Promise.resolve(t).then(function(t){e.setData(t)})}}();return r&&r.then?r.then(i):i()}e.index++}();return Promise.resolve(o&&o.then?o.then(i):i())}catch(t){return Promise.reject(t)}},updateValue:function(t){this.localValue=t,this.$emit("input",t)},selectRange:function(t,e){this.$el.focus(),this.$el.setSelectionRange(t,e)},getCursorPos:function(){return this.$el.selectionStart}}};
//# sourceMappingURL=tab-complete-input.mjs.map
